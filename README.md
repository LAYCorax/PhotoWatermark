# PhotoWatermark GUI 版本

## 项目概述

PhotoWatermark 是一个专业的照片水印桌面应用程序，采用 MaaAssistantArknights 项目的设计风格，提供直观易用的图形界面用于批量添加文本和图片水印。

## 项目结构

```
PhotoWatermark/
├── main.py                    # 应用程序主入口
├── launcher.py                # 依赖检查和启动器
├── requirements.txt           # 项目依赖
├── ui/                        # UI模块
│   ├── __init__.py
│   ├── main_window.py         # 主窗口实现
│   ├── dialogs/               # 对话框模块
│   │   └── __init__.py
│   └── widgets/               # 自定义控件
│       ├── __init__.py
│       ├── image_list_widget.py      # 图片列表控件
│       ├── preview_widget.py         # 预览控件
│       └── watermark_config_widget.py # 水印配置控件
├── core/                      # 核心逻辑模块
│   └── __init__.py
├── models/                    # 数据模型
│   ├── __init__.py
│   ├── image_info.py          # 图片信息模型
│   └── watermark_config.py    # 水印配置模型
├── utils/                     # 工具函数
│   ├── __init__.py
│   └── file_utils.py          # 文件操作工具
├── resources/                 # 资源文件
│   ├── icons/                 # 图标资源
│   └── styles/                # 样式文件
└── config/                    # 配置文件
```

## 技术特性

### 已实现功能 (第一迭代)

#### 1. 基础框架
- ✅ 基于 PyQt5 的现代化 GUI 框架
- ✅ MaaAssistantArknights 设计风格的界面
- ✅ 响应式三栏布局 (图片列表 + 预览 + 配置面板)
- ✅ 完整的菜单系统和状态栏
- ✅ 高DPI显示支持

#### 2. 文件管理
- ✅ 支持拖拽导入图片文件
- ✅ 文件选择器批量导入
- ✅ 文件夹导入 (支持递归扫描)
- ✅ 支持主流图片格式: JPEG, PNG, BMP, TIFF
- ✅ PNG 透明通道检测和处理
- ✅ 文件验证和错误处理

#### 3. 图片列表管理
- ✅ 缩略图异步生成和显示
- ✅ 文件信息展示 (尺寸、大小、格式)
- ✅ 批量选择和管理
- ✅ 右键菜单操作
- ✅ 实时状态更新

#### 4. 预览功能
- ✅ 高质量图片预览
- ✅ 缩放控制 (放大、缩小、适应窗口)
- ✅ 鼠标滚轮缩放支持
- ✅ 实时水印预览
- ✅ 图片切换预览

#### 5. 水印配置
- ✅ 文本水印完整配置界面
  - 文本内容输入
  - 字体选择 (系统字体)
  - 字号调节 (滑块+数值框)
  - 字体样式 (粗体、斜体)
  - 颜色选择器
  - 透明度调节
- ✅ 图片水印配置界面
  - 图片文件选择
  - 缩放比例调节
  - 透明度控制
  - 宽高比保持选项
- ✅ 位置配置
  - 九宫格预设位置
  - 边距调节
  - 自定义位置支持 (框架)

#### 6. 数据模型
- ✅ 完整的水印配置数据模型
- ✅ 图片信息管理模型
- ✅ 配置序列化支持 (JSON)
- ✅ 类型安全的枚举定义

### 设计亮点

1. **模块化架构**: 清晰的 MVC 分层，便于维护和扩展
2. **信号-槽机制**: 高效的组件间通信
3. **异步处理**: 缩略图生成不阻塞 UI
4. **错误处理**: 完善的异常处理和用户提示
5. **可扩展设计**: 为高级功能预留接口

## 安装和运行

### 系统要求
- Windows 10 或更高版本
- Python 3.8+
- 4GB RAM (推荐)
- 100MB 可用磁盘空间

### 依赖安装

```bash
# 方法1: 使用 requirements.txt
pip install -r requirements.txt

# 方法2: 手动安装主要依赖
pip install PyQt5 Pillow piexif
```

### 运行应用

```bash
# 使用启动器 (推荐)
python launcher.py

# 直接运行主程序
python main.py
```

## 开发进度

### ✅ 第一迭代 (已完成)
- [x] 项目框架搭建
- [x] 基础 UI 实现  
- [x] 文件导入功能
- [x] 图片列表管理
- [x] 预览功能
- [x] 基础水印配置

### 🚧 第二迭代 (规划中)
- [ ] 水印渲染引擎优化
- [ ] 批量导出功能
- [ ] 导出设置对话框
- [ ] 处理进度显示
- [ ] 错误日志系统

### 🔮 第三迭代 (规划中)
- [ ] 高级文本特效 (阴影、描边)
- [ ] 图片水印旋转功能
- [ ] 拖拽定位功能
- [ ] 实时预览优化

### 🎯 第四迭代 (规划中)
- [ ] 模板管理系统
- [ ] 配置导入导出

## 代码特性

### 设计模式应用
- **观察者模式**: UI 组件响应数据模型变化
- **工厂模式**: 水印类型创建
- **单例模式**: 配置管理
- **策略模式**: 不同水印类型的处理策略

### 性能优化
- 异步缩略图生成
- 图片内存管理
- UI 响应优化
- 大文件处理策略

### 用户体验
- 直观的三栏布局
- 实时预览反馈
- 拖拽操作支持
- 完善的错误提示
- 快捷键支持

## 技术文档

详细的技术设计文档请参考：
- [PhotoWatermark_GUI_Design.md](PhotoWatermark_GUI_Design.md) - 完整设计文档

## 许可证

MIT License

## 更新日志

### v1.0.0 (2025-10-02)
- 🎉 首个版本发布
- ✨ 完整的 GUI 框架
- ✨ 基础水印功能
- ✨ 文件导入和预览
- 🐛 修复多项稳定性问题

---

**PhotoWatermark** - 让照片水印变得简单专业